# SPDX-FileCopyrightText: 2025 Alexandre Gomes Gaigalas <alganet@gmail.com>
#
# SPDX-License-Identifier: ISC

[general]
listen = "127.0.0.1:3000"
captures = "captures.jsonl"
ttl_seconds = 300
captures_seed = false

[tls]
enabled = true
ca_cert_path = "ca.crt"
ca_key_path = "ca.key" 
passthrough_domains = ["example.com"]
suppress_headers = ["X-Sensitive-Header"]


# Client Rules
[rules.client_accept_encoding_present]
enabled = true
severity = "info"

[rules.client_user_agent_present]
enabled = true
severity = "info"

[rules.client_cache_respect]
enabled = true
severity = "warn"

[rules.message_connection_upgrade]
enabled = true
severity = "warn"

# Server Rules
[rules.server_cache_control_present]
enabled = true
severity = "warn"

[rules.server_etag_or_last_modified]
enabled = true
severity = "info"

[rules.server_x_content_type_options]
enabled = true
severity = "warn"
content_types = ["text/html", "application/javascript", "application/json"]

[rules.server_response_405_allow]
enabled = true
severity = "warn"

[rules.server_charset_specification]
enabled = true
severity = "warn"

[rules.server_clear_site_data]
enabled = true
severity = "warn"
paths = ["/logout", "/signout", "/auth/logout", "/api/v1/logout"]

# Correctness rules examples
[rules.client_host_header]
enabled = true
severity = "warn"

[rules.client_request_method_token_uppercase]
enabled = true
severity = "warn"

[rules.client_request_target_no_fragment]
enabled = true
severity = "error"

[rules.client_request_uri_percent_encoding_valid]
enabled = true
severity = "error"

[rules.server_content_type_present]
enabled = true
severity = "warn"

[rules.message_content_type_well_formed]
enabled = true
severity = "warn"

[rules.message_content_length_vs_transfer_encoding]
enabled = true
severity = "warn"

[rules.message_content_length]
enabled = true
severity = "warn"

[rules.message_header_field_names_token]
enabled = true
severity = "warn"

[rules.message_transfer_encoding_chunked_final]
enabled = true
severity = "warn"

[rules.message_connection_header_tokens_valid]
enabled = true
severity = "warn"

[rules.server_no_body_for_1xx_204_304]
enabled = true
severity = "error"

[rules.server_status_code_valid_range]
enabled = true
severity = "error"
