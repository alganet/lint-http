# SPDX-FileCopyrightText: 2025 Alexandre Gomes Gaigalas <alganet@gmail.com>
#
# SPDX-License-Identifier: ISC

[general]
listen = "127.0.0.1:3000"
captures = "captures.jsonl"
ttl_seconds = 300
captures_seed = false

[tls]
enabled = true
ca_cert_path = "ca.crt"
ca_key_path = "ca.key" 
passthrough_domains = ["example.com"]
suppress_headers = ["X-Sensitive-Header"]


# Client Rules
[rules.client_accept_encoding_present]
enabled = true
severity = "info"

[rules.client_user_agent_present]
enabled = true
severity = "info"

[rules.client_cache_respect]
enabled = true
severity = "warn"

[rules.message_connection_upgrade]
enabled = true
severity = "warn"

# Server Rules
[rules.server_cache_control_present]
enabled = true
severity = "warn"

[rules.server_etag_or_last_modified]
enabled = true
severity = "info"

[rules.message_etag_syntax]
enabled = true
severity = "warn"

[rules.server_last_modified_rfc1123_format]
enabled = true
severity = "warn"

[rules.server_location_header_uri_valid]
enabled = true
severity = "warn"

[rules.server_response_location_on_redirect]
enabled = true
severity = "warn"

[rules.server_x_content_type_options]
enabled = true
severity = "warn"
content_types = ["text/html", "application/javascript", "application/json"]

[rules.server_x_frame_options_value_valid]
enabled = true
severity = "warn"

[rules.server_x_xss_protection_value_valid]
enabled = true
severity = "warn"

[rules.server_response_405_allow]
enabled = true
severity = "warn"

[rules.server_charset_specification]
enabled = true
severity = "warn"

[rules.server_clear_site_data]
enabled = true
severity = "warn"
paths = ["/logout", "/signout", "/auth/logout", "/api/v1/logout"]

# Correctness rules examples
[rules.client_host_header]
enabled = true
severity = "warn"

[rules.client_request_method_token_uppercase]
enabled = true
severity = "warn"

[rules.client_expect_header_valid]
enabled = true
severity = "error"

[rules.client_request_target_no_fragment]
enabled = true
severity = "error"

[rules.client_request_target_form_checks]
enabled = true
severity = "error"

[rules.server_accept_ranges_values_valid]
enabled = true
severity = "warn"

[rules.server_vary_header_valid]
enabled = true
severity = "warn"

[rules.server_patch_accept_patch_header]
enabled = true
severity = "warn"

[rules.server_server_timing_header_syntax]
enabled = true
severity = "warn"

[rules.server_deprecation_header_syntax]
enabled = true
severity = "warn"

[rules.server_alt_svc_header_syntax]
enabled = true
severity = "warn"

[rules.server_problem_details_content_type]
enabled = true
severity = "warn"

[rules.client_range_header_syntax_valid]
enabled = true
severity = "error"

[rules.message_range_and_content_range_consistency]
enabled = true
severity = "warn"

[rules.client_request_uri_percent_encoding_valid]
enabled = true
severity = "error"

[rules.client_request_origin_header_present_for_cors]
enabled = true
severity = "warn"

[rules.server_content_type_present]
enabled = true
severity = "warn"

[rules.message_content_type_well_formed]
enabled = true
severity = "warn"

[rules.message_cache_control_token_valid]
enabled = true
severity = "warn"

[rules.message_content_disposition_token_valid]
enabled = true
severity = "warn"

[rules.message_content_disposition_parameter_validity]
enabled = true
severity = "warn"

[rules.message_accept_header_media_type_syntax]
enabled = true
severity = "warn"

[rules.message_language_tag_format_valid]
enabled = true
severity = "warn"

[rules.message_priority_header_syntax]
enabled = true
severity = "warn"

[rules.message_referer_uri_valid]
enabled = true
severity = "warn"

[rules.message_from_header_email_syntax]
enabled = true
severity = "warn"

[rules.message_access_control_allow_credentials_when_origin]
enabled = true
severity = "warn"

[rules.message_access_control_allow_origin_valid]
enabled = true
severity = "warn"

[rules.message_cross_origin_opener_policy_valid]
enabled = true
severity = "warn"

[rules.message_cross_origin_resource_policy_valid]
enabled = true
severity = "warn"

[rules.message_cross_origin_embedder_policy_valid]
enabled = true
severity = "warn"

[rules.message_content_encoding_iana_registered]
enabled = true
severity = "warn"
allowed = ["aes128gcm", "br", "compress", "dcb", "dcz", "deflate", "exi", "gzip", "identity", "pack200-gzip", "x-compress", "x-gzip", "zstd"]

[rules.message_transfer_coding_iana_registered]
enabled = true
severity = "warn"
allowed = ["chunked", "gzip", "deflate"]

[rules.message_content_transfer_encoding_valid]
enabled = true
severity = "warn"

[rules.message_te_header_constraints]
enabled = true
severity = "warn"

[rules.message_digest_header_syntax]
enabled = true
severity = "warn"

[rules.message_if_none_match_etag_syntax]
enabled = true
severity = "warn"

[rules.message_if_match_etag_syntax]
enabled = true
severity = "warn"

[rules.message_if_modified_since_date_format]
enabled = true
severity = "warn"

[rules.message_http_version_syntax_valid]
enabled = true
severity = "error"

[rules.message_content_length_vs_transfer_encoding]
enabled = true
severity = "warn"

[rules.message_content_length]
enabled = true
severity = "warn"

[rules.message_header_field_names_token]
enabled = true
severity = "warn"

[rules.message_transfer_encoding_chunked_final]
enabled = true
severity = "warn"

[rules.message_via_header_syntax_valid]
enabled = true
severity = "warn"

[rules.message_connection_header_tokens_valid]
enabled = true
severity = "warn"

[rules.message_retry_after_date_or_delay]
enabled = true
severity = "warn"

[rules.message_prefer_header_valid]
enabled = true
severity = "warn"

[rules.message_preference_applied_header_valid]
enabled = true
severity = "warn"

[rules.message_max_forwards_numeric]
enabled = true
severity = "warn"

[rules.message_age_header_numeric]
enabled = true
severity = "warn"

[rules.message_allow_header_method_tokens]
enabled = true
severity = "error"

[rules.server_no_body_for_1xx_204_304]
enabled = true
severity = "error"

[rules.server_status_code_valid_range]
enabled = true
severity = "error"
